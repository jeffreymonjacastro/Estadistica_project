---
title: "PG1-informe"
author: "Grupo 9"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  html_document:
    toc: yes
    df_print: paged
  html_notebook:
    toc: yes
    toc_float:
      collapsed: no
      smooth_scroll: no
    number_sections: yes
    theme: yeti
---

![UTEC - Universidad de Ingeniería y Tecnología](https://proyectos.utec.edu.pe/themes/custom/utec/logo.png)

**Integrantes**

| **Apellidos y Nombres**                 | **Código**  | **Carrera**                 |
|-------------------------------|------------------|-----------------------|
| *Herrera Salazar, Sofia Brenda*         | *202210167* | *Ciencia de la computación* |
| *Llallire Meza, Mateo Gabriel*          | *202210187* | *Ciencia de Datos*          |
| *Machuca Lazaro, Loriana Betsy (líder)* | *202020100* | *Bioingeniería*             |
| *Mendocilla Pariona, Williams Pascual*  | *202110217* | *Ingeniería Química*        |
| *Soto Mayta, Benjamin*                  | *202210550* | *Ciencia de la computación* |

# Tema delimitado:

Análisis de los factores involucrados y relaciones en el proceso de aprendizaje de inglés de los estudiantes de UTEC durante el periodo académico 2023-1.

# Introducción

## Relevancia

Nosotros hemos decidido realizar el tema por dos motivos principales:

-   Analizar cómo la carga académica de la malla curricular de cada estudiante afecta a la cantidad de tiempo y energía que los estudiantes de UTEC tienen disponible para dedicar al aprendizaje del inglés.

-   Entender los factores influyentes en el aprendizaje del inglés durante un ciclo regular, esta información es valiosa para maximizar el aprendizaje en entornos académicos con alta carga de trabajo, y también para la toma de decisiones en la planificación académica universitaria.

Es importante destacar que este estudio se centra en el periodo académico 2023-1 y en los estudiantes de UTEC. Esto nos permitirá obtener información específica y relevante para esta institución. Con estos datos, podremos realizar recomendaciones y conclusiones basadas en evidencia con el objetivo de mejorar el proceso de enseñanza-aprendizaje del inglés.

## Objetivos

-   Analizar las variables involucradas en el aprendizaje del inglés de los estudiantes de UTEC en el periodo 2023-1.

-   Identificar las dificultades, factores y circunstancias que enfrentan los estudiantes de UTEC y su relación con el aprendizaje del inglés durante el periodo 2023-1 en distintas instituciones que enseñan el inglés.

-   Informar al Centro de Idiomas Conversa Academics sobre los resultados académicos, incluyendo evaluaciones y nivel de competencia del idioma, que atraviesan sus estudiantes en comparación con otros centros de idiomas de inglés.

## Contexto:

Para facilitar un mejor aprendizaje del idioma, es importante tener en cuenta diversos aspectos, como los programas educativos, el periodo académico, la carga académica y las competencias lingüísticas necesarias para los estudiantes de UTEC. Con el fin de recopilar información sobre la correlación entre la carga académica del ciclo regular y el aprendizaje del inglés en los estudiantes de UTEC durante el periodo 2023-1, llevaremos a cabo este estudio.

# Datos

## Proceso de recolección de datos

Nosotros como grupo hemos decidido optar en hacer encuestas a partir de una fuente primaria, todo ello lo realizaremos vía "Google Forms", es una herramienta muy útil y reconocida para crear, analizar encuestas sin tener un software en especial ademas los resultados aparecerán instantáneamente en el momento en el que concluyen de terminar con las preguntas de las encuestas y ademas puedes obtener gráficas de los resultados.

Para empezar, la razón por la que optamos por trabajar con encuestas es tener una muestra estadística a partir de las respuestas brindadas por los estudiantes UTEC. Por otro lado, las condiciones que establecían la recolección de datos fueron responder la encuesta de manera adecuada y honesta. Finalmente, en cuanto las estrategias para llegar a la población, fue preguntando a los estudiantes en los lugares más concurridos de la universidad como en los espacios verdes o esperar a una clase que termine en aulas o auditorios y encuestar a los estudiantes.

## Población, muestra y muestreo

-   Población : Estudiantes de UTEC

-   Muestra : 166 Estudiantes de UTEC que respondieron la encuesta

-   Muestreo : Muestreo por conveniencia.

## Variables

| Variables                                                                         | Tipo                 | Restricción                                                                                                                                                                                      |
|------------------|------------------|-------------------------------------|
| `Créditosacadémicos (Creditos)`                                                   | Numérica → Discreta  | Números enteros mayor o igual a 12 y menor igual a 26.                                                                                                                                           |
| `Número de cursos (NumCursos)`                                                    | Numérica → Discreta  | Números enteros positivos enteros mayor o igual a 3 y menor o igual que 9 cursos.                                                                                                                |
| `Promedio ponderado de exámenes de inglés (Promedio_Ingles)`                      | Numérica → Discreta  | Números positivos mayor igual a 0 y menor o igual a 20.                                                                                                                                          |
| `Estado emocional (Nivel_Estres)`                                                 | Categórica → Ordinal | Nivel de estado emocional en una escala del 1 al 5.                                                                                                                                              |
| `Nivel de competencia (Nivel_Competencia)`                                        | Categórica → Nominal | Básico, Intermedio o Avanzado .                                                                                                                                                                  |
| `Número de meses estudiando (Meses_Estudio)`                                      | Numérica → Discreta  | Números enteros mayor o igual a 1, en el caso que hayan respondido que sí estudiaron en un centro de idiomas, caso contrario es considerado NA.                                                  |
| `Cantidad de horas dedicadas en el estudio de ingles a la semana (Horas_Estudio)` | Categórica → Nominal | Rangos de horas: "0 h", "1 a 2h","3 a 4h", "más de 4h", en el caso que hayan respondido que sí estudiaron en un centro de idiomas, caso contrario es considerado NA.                             |
| `Instituto de idiomas donde estudias ingles (Instituto)`                          | Categórica → Nominal | Alternativas de instituto de idiomas: ICPNA, Británico, Conversa Academics y otros, en el caso que hayan respondido que sí estudiaron en un centro de idiomas, caso contrario es considerado NA. |
| `Calidad de enseñanza de tu formación del inglés (Calidad)`                       | Categórica → Ordinal | Alternativas desde Deficiente a Excelente en una escala del 1 al 5, en el caso que hayan respondido que sí estudiaron en un centro de idiomas, caso contrario es considerado NA.                 |
| `Dificultades para aprender inglés (Factor)`                                      | Categórica → Nominal | Alternativas entre: Carga académica, Escasa motivación, Escasos recursos adecuados, otros.                                                                                                       |
| `Horario disponible para clases de inglés (Horario_estudio_ingles)`               | Categórica → Nominal | Alternativas entre: Mañana, tarde y noche.                                                                                                                                                       |
| `Día disponibles para clases de inglés (Dias_clases)`                             | Categórica → Nominal | Alternativas entre: Diario, Fines de semana e intermediario.                                                                                                                                     |
| `Clases asistidas (Clases_asistidas)`                                             | Numérica → Discreta  | Números enteros mayor o igual a 1, en el caso que hayan respondido que sí estudiaron en un centro de idiomas, caso contrario es considerado NA.                                                  |
| `Clases totales (Clases_totales)`                                                 | Numérica → Discreta  | Números enteros mayor o igual a 1, en el caso que hayan respondido que sí estudiaron en un centro de idiomas, caso contrario es considerado NA.                                                  |
| `Porcentaje de asistencia (Porcentaje_asist)`                                     | Numérica → Continua  | Números positivos mayor o igual a 0% y menor o igual a 100%                                                                                                                                      |
| `Números de tareas asignadas de la UTEC (Tareas_semana)`                          | Numérica → Discreta  | Número enteros positivos mayor o igual a 1 y menor o igual a 15 tareas.                                                                                                                          |

## Link de las preguntas del Google Forms:

[Click aqui para obtener las preguntas de las encuestas] (<https://docs.google.com/forms/d/e/1FAIpQLSe0quCo-wEQftHW6dkrEUJSe5xyTq036OyZp_sjh5WlBUHemQ/viewform?usp=sf_link>)

## Limpieza de datos

### Carga de Datos

```{r}
    library(readr)
    library(dplyr)
    DF<- read_csv("DB1.csv")
    
```

Vamos a crear funciones para realizar algunos descriptores:

```{r}
r <- function(n){
  round(n, 2)
}
```

```{r}
cv <- function(X){
  return(sd(X, na.rm = T) / mean(X, na.rm = T))
}
```

```{r}
rango <- function(X){
  return(max(X, na.rm = T) - min(X, na.rm = T))
}
```

Tenemos la siguiente cantidad de observaciones:

```{r}
  nrow(DF)
```

Procedemos a analizar el tipo de dato de cada variable

```{r}
  spec(DF)
```

Por el momento, todas las variables tienen el tipo de dato que les corresponde.

### Clases Totales y Clases Asistidas

Vamos a analizar si existen casos en los que la variable `Clases_Totales` es menor que la variable `Clases_asistidas`

```{r}
  any(DF$Clases_totales < DF$Clases_asistidas , na.rm = TRUE)
```

Notamos que si existen ahora veremos cuantas observaciones hay

```{r}
DF %>% filter(Clases_asistidas > Clases_totales)

```

Hay 8 observaciones donde se cumple esta incoherencia

Debemos asignar NA a las variables `Clases_totales` y `Clases_asistidas` en dichas observaciones

```{r}
DF$Clases_asistidas[DF$Clases_totales < DF$Clases_asistidas] <- NA
DF$Clases_totales[which(is.na(DF$Clases_asistidas))]<-NA
```

Comprobamos que ya no existen observaciones con ese error:

```{r}
  any(DF$Clases_totales < DF$Clases_asistidas , na.rm = TRUE)
```

Vemos un caso en particular

```{r}
DF[grep("ivan.rodriguez@utec.edu.pe", DF$`Dirección de correo electrónico`), ]

```

Efectivamente, su valor en ambas variables es `NA`

```{r}
sum(!is.na(DF$Clases_totales))
```

```{r}
sum(!is.na(DF$Clases_asistidas))
```

El tamaño efectivo de la muestra para las variables `Clases_totales` y `Clases_asistidas` es 135 para ambas variables.

### Personas que llenaron más de una vez la encuesta

Veamos si existen personas que llenaron la encuesta más de una vez:

```{r}

sum(duplicated(DF$`Correo UTEC`))

```

Efectivamente, existen 3 personas que llenaron la encuesta más de una vez.

```{r}
indices_duplicados <- which(duplicated(DF$`Correo UTEC`))
indices_duplicados
valores_duplicados <- DF$`Correo UTEC`[indices_duplicados]
valores_duplicados
```

Hemos enviado un correo a los 3 estudiantes que respondieron más de una vez para preguntarles cuál de sus respuestas fue correcta. Ante ello, nos indicaron cuál fue la correcta.

```{r}
DF<-DF[!(DF$`Correo UTEC`== 'fabrizio.flores@utec.edu.pe' & DF$Tareas_semana!=4), ]
DF<-DF[!(DF$`Correo UTEC`== 'jose.herrada@utec.edu.pe' & DF$Promedio_Ingles!=15),]
DF<-DF[!(DF$`Correo UTEC`== 'franco.larosa@utec.edu.pe' & DF$Promedio_Ingles!=14),]
```

```{r}
sum(duplicated(DF$`Correo UTEC`))
```

Aquí observamos un ejemplo de como el alumno que antes solía tener dos respuestas, ahora solo tiene 1:

```{r}
DF[grep('franco.larosa@utec.edu.pe', DF$`Dirección de correo electrónico`), ]
```

Inicialmente teníamos 166 unidades muestrales en nuestra base de datos. Luego de eliminar las observaciones repetidas nos quedan 163 unidades muestrales.

```{r}
nrow(DF)
```

### Variable Meses_Estudio

Aparentemente no tiene sentido que la variable`Meses_Estudio` sea mayor a 36.

```{r}
DF %>% select(`Correo UTEC` , Meses_Estudio)  %>% filter(Meses_Estudio > 36)
```

Sin embargo, se le envío un correo a los encuestados para corroborar sus datos y fueron los siguientes quienes corrigieron esta cifra, los demás afirmaron que estaba correcto:

```{r}
DF$Meses_Estudio[DF$`Correo UTEC` == "valeria.valdez@utec.edu.pe"] =  24  
DF$Meses_Estudio[DF$`Correo UTEC` == "cecilia.pilco@utec.edu.pe"] =  11  
```

```{r}
DF %>% filter(Meses_Estudio > 36)
```

```{r}
sum(!is.na(DF$Meses_Estudio))
```

El tamaño efectivo de la muestra para la variable `Meses_Estudio` es 140.

### Variable Promedio_Ingles

Veamos la variable `Promedio_Ingles`

```{r}
DF %>% select(Promedio_Ingles)
```

Notamos que hay algunos valores que no son enteros. Para efecto de nuestro estudio redondearemos estos valores.

```{r}
DF$Promedio_Ingles = round(DF$Promedio_Ingles)
```

```{r}
DF %>% select(Promedio_Ingles)
```

Como vemos ahora todos los valores de esta variable son enteros.

### Horas de Estudio

```{r}
table(DF$Horas_estudio_ingles)
```

```{r}
DF[grep('lynn.ortega@utec.edu.pe', DF$`Dirección de correo electrónico`),]
```

Vemos que tiene Opción 5 en horas de estudio. Pondremos este valor como `NA`

```{r}
DF$Horas_estudio_ingles[grep('lynn.ortega@utec.edu.pe', DF$`Dirección de correo electrónico`)] <- NA
```

Ahora el valor de la variable en esa observación es `NA`

```{r}
DF[grep('lynn.ortega@utec.edu.pe', DF$`Dirección de correo electrónico`),]
```

```{r}
sum(!is.na(DF$Horas_estudio_ingles))
```

El tamaño efectivo de la muestra para la variable `Horas_estudio_ingles` es 162.

### Variable Calidad

```{r}
mode(DF$Calidad)

DF %>% select(Calidad)
DF$Calidad <- as.character(DF$Calidad)

```

Cambiamos el tipo de dato de la variable `Calidad`

```{r}
mode(DF$Calidad)
```

```{r}
sum(!is.na(DF$Calidad))
```

El tamaño efectivo de la muestra para la variable `Calidad` es 140

### Variable Institución

Examinemos la variable `Institución`

```{r}
table(DF$Institucion) 
```

Notamos que las observaciones de la variable cuyo valor es `Nunca estudie en un instituto de idiomas` están de más. Por ello, le daremos un valor `NA`.

```{r}
DF$Institucion[grep('Nunca estudie en un instituto de idiomas', DF$Institucion)] <- NA
```

Las observaciones `Mi colegio tenía curso de inglés y separaba por niveles.` tampoco tienen mucho sentido. Lo mismo para `Ninguna solo colegio` y `Personal`

```{r}
DF$Institucion[grep('Mi colegio tenía curso de inglés y separaba por niveles.', DF$Institucion)] <- NA
DF$Institucion[grep('Ninguna solo colegio', DF$Institucion)] <- NA
DF$Institucion[grep('Personal', DF$Institucion)] <- NA
```

Las observaciones `Britanico e Idiomas Catolica` y `Británico pero avanzado en ICPNA` le quitan la prolijidad a nuestra base de datos. Por ello, les asignaremos `NA`.

```{r}
DF$Institucion[grep('Britanico e Idiomas Catolica', DF$Institucion)] <- NA
```

```{r}
DF$Institucion[grep('Británico pero avanzado en ICPNA', DF$Institucion)] <- NA
```

```{r}
table(DF$Institucion)
```

```{r}
sum(!is.na(DF$Institucion))
```

El tamaño efectivo de la muestra para la variable `Institución` es 135.

### Variable Nivel de Competencia

La variable es categórica ordinal. Es conveniente usar el comando `levels` con el parámetro `Ordered` ya que `R` no reconoce el orden para esta variable.

```{r}
table(DF$Nivel_Competencia)
```

```{r}
DF$Nivel_Competencia <- factor(DF$Nivel_Competencia, levels = c("Básico", "Intermedio", "Avanzado"), ordered = TRUE)

tail(DF$Nivel_Competencia)
```

```{r}
table(DF$Nivel_Competencia)
```

```{r}
sum(!is.na(DF$Nivel_Competencia))
```

El tamaño efectivo de la muestra para la variable `Nivel_Competencia` es 156.

### Cálculo del porcentaje de Asistencia

Procedemos a calcular el porcentaje de asistencia en base a las variables `Clases_totales` y `Clases_asistidas`

```{r}
DF <- DF %>% mutate(porcentaje_asist  =  (DF$Clases_asistidas/DF$Clases_totales)*100) 
```

Vemos La nueva columna

```{r}
DF %>% select(porcentaje_asist)
```

```{r}
table(!is.na(DF$porcentaje_asist))
```

### Variable Factor

Esta variable nos indica el factor principal que limita el aprendizaje del inglés para cada alumno.

```{r}
table(DF$Factor)

```

Para efectos de la encuesta pusimos descripciones largas de cada uno de estos factores. Sin embargo, para efectos de visualización será mejor re nombrarlos.

```{r}
DF$Factor[DF$Factor == "Escasa motivación o interés por tal idioma"] <- "Escasa motivación"

DF$Factor[DF$Factor == "Escasos recursos adecuados (económico, material, etc.)"] <-
"Escasos recursos"  

DF$Factor[DF$Factor == "Falta de tiempo por la carga académica"] <- "Carga Académica"

DF$Factor[DF$Factor == "Falta de tiempo por responsabilidades externas (personal, familiar , laboral, etc.)"] <- "Responsabilidades extenernas"


```

```{r}
DF %>% group_by(Factor) %>% summarise(total = n())
```

```{r}
sum(!is.na(DF$Factor))
```

El tamaño efectivo de la muestra para la variable `Factor` es 163.

# Análisis Descriptivo

## Análisis Univariado

### Variable Institución

Después de realizar la limpieza, tenemos lo siguiente:

```{r}
table(!is.na(DF$Institucion))
```

```{r}
DF %>% group_by(Institucion) %>% summarise(total = n()) %>% arrange(-total)
```

En base a la tabla, los alumnos encuestados se reparten entre 16 Instituciones de Ingles de las cuales, existen tres Institutos de idiomas que preponderan de manera notoria sobre los otros. En primer lugar, `ICPNA` (40) (moda) , `Británico` (39) y `Conversa Academics (UTEC)` (37). Además, hay 11 instituciones que aparecen solo una vez en nuestra muestra.

Usaremos un `barplot`.

```{r}
Orden <- order(table(DF$Institucion), decreasing = TRUE) 
barplot(table(DF$Institucion)[Orden] 
        , las = 3 
        , cex.names = 0.4
        , col = c("blue3", "red", "cyan", rep("gray", length(unique(DF$Institucion))-3))
        )
```

En términos de porcentajes:

```{r}
DF %>% group_by(Institucion) %>% summarise(Porcentaje = (n()/nrow(DF))*100 ) %>% arrange(-Porcentaje)
```

Podemos analizar de mejor manera esta variable si conservamos a los 3 institutos que más se repiten y asignamos el valor de "Otros" a los demás.

```{r}
DF$Ins <- factor(DF$Institucion, levels = c("Conversa Academics-UTEC"
                                            , "ICPNA"                                                    
                                            , "Británico"                                                
                                            , "Euroidiomas"                                              
                                            , "El Cultural"                                              
                                            , "Universidad San Martin de Porres"                         
                                            , "Idiomas católica"                                         
                                            , "Centro idiomas"                                           
                                            , "USMP"                                                     
                                            , "ASDI"                                                     
                                            , "B-nice"                                                   
                                            , "Facultad de Lenguas de la Universidad Nacional de Córdoba"
                                            , "Pacífico"                                                 
                                            , "EuroCenter"                                               
                                            , "Open English"                                             
                                            , "April"
                                            )
                 , labels =  c("Conversa Academics-UTEC"
                                            , "ICPNA"
                                            , "Británico"                                                
                                            , "Otro"                                              
                                            , "Otro"                                              
                                            , "Otro"                         
                                            , "Otro"                                         
                                            , "Otro"                                           
                                            , "Otro"                                                     
                                            , "Otro"                                                     
                                            , "Otro"                                                   
                                            , "Otro"
                                            , "Otro"                                                 
                                            , "Otro"                                               
                                            , "Otro"                                              
                                            , "Otro" 
                             )
)

```

De esta manera, tenemos una nueva columna `Ins`que representa a los Institutos pero con menos categorías. Además, podemos visualizar a `Conversa UTEC` contra sus otros competidores de una manera más clara.

```{r}
bar <- barplot(
        round(prop.table(table(DF$Ins, useNA = "ifany")) ,2)
        , ylim = c(0 , max(prop.table(table(DF$Ins, useNA = "ifany")))*1.5)
        , col = c("cyan", "blue3", "red", "lightgray", "darkgray")
        , xaxt = "n",
        main="Frecuencia relativa de institutos de inglés"
        , xlab = "Instituto de Inglés"
        , ylab = "Frecuecia Relativa"
        )


axis(1 , at = bar , labels =  c("Conversa(UTEC)" , "ICPNA" , "Británico" , "Otros" , "Sin Institución"))


text(bar , y = round(prop.table(table(DF$Ins, useNA = "ifany")),2) , 
     labels = round(prop.table(table(DF$Ins, useNA = "ifany")) ,2) , pos = 3 )
```

En la muestra, el 23% de los alumnos pertenece a `Conversa(UTEC)`, el 25% pertenece a `ICPNA` , el 12% pertenecen a la categoría de `Otros` y el 17% no pertenece a ninguna institución de inglés.

### Variable Nivel de Competencia

Después de la Limpieza, tenemos lo siguiente

```{r}
table(!is.na(DF$Nivel_Competencia))
```

El tamaño efectivo de la muestra para la variable Nivel de Competencia es 156

La variable es categórica ordinal, por ello mostraremos un gráfico de barras

```{r}
proporciones <- round(prop.table(table(DF$Nivel_Competencia)) , 2)

b <-barplot(proporciones , 
            ylim = c(0, max(proporciones)*1.2)  
            , col = c("lightgray" , "lightblue" , "blue4"),
            main="Nivel de Competencia y su frecuencia relativa"
            , xlab = "Nivel de Competencia"
            , ylab = "Frecuencia Relativa"
            )
text(b , y = proporciones , labels = proporciones , pos = 3 )
```

El nivel intermedio es el que más se repite (moda) con el 41%

### Variable Calidad

Después de la limpieza, tenemos

```{r}
table(!is.na(DF$Calidad))
```

El tamaño efectivo de la muestra para esta variable es 140.

La variable es categórica ordinal, por ello haremos un gráfico de barras.

```{r}
proporciones <- round(prop.table(table(DF$Calidad)) , 2)

b <-barplot(proporciones , 
            ylim = c(0, max(proporciones)*1.2)  
            , col = c("red" , "orange" , "yellow" , "green" , "blue4"),
            main="Nivel de calidad de instituciones de inglés y su frecuencia relativa",
             xlab = "Nivel de Calidad"
            , ylab = "Frecuencia Relativa", sub="Siendo 1= Deficiente y 5= Excelente"
            )
text(b , y = proporciones , labels = proporciones , pos = 3 )
```

El 49% de las observaciones corresponden a alumnos que consideran que su institución tiene una calidad de 4 en una escala del 1 al 5 (moda)

### Variable Número de Cursos

Después de la limpieza, tenemos:

```{r}
table(!is.na(DF$NumCursos))
```

El tamaño efectivo de la muestra para la variable Número de cursos es 163. Es decir, no tiene `NA`.

Veamos los mínimos y máximos

```{r}
summary(DF$NumCursos)
```

#### Promedio

```{r}
r(mean(DF$NumCursos,na.rm=T))
```

En esta muestra, los estudiantes llevan en promedio 5.53 cursos.

#### Mediana

```{r}
r(median(DF$NumCursos,na.rm=T))
```

En esta muestra, por lo menos el 50 de los estudiantes tiene un numero de cursos mayor o igual a 6 y, por lo menos el 50% un numero de cursos menor o igual que 6

#### Moda

```{r}
DF %>% count(NumCursos) %>% arrange(-n)
```

En esta muestra, la mayoría de alumnos llevan 6 cursos.

#### Coeficiente de variación

```{r}
r(cv(DF$NumCursos))
```

El coeficiente de variación es de 0.19 (menor que 0.3) . Por ello, el promedio es una buena medida de posición en nuestra muestra.

#### Rango

```{r}
range(DF$NumCursos)
```

```{r}
diff(range(DF$NumCursos))
```

Estos valores indican el mínimo de créditos registrados es 3 y el máximo es 8. Por ello, el rango de la variable es 5.

La variable es numérica discreta. Veamos la cantidad de valores únicos que toma.

```{r}
unique(DF$NumCursos)
```

Haremos un gráfico de barras con frecuencia relativa.

```{r}
proporciones <- round(prop.table(table(DF$NumCursos)) , 2)

b <-barplot(proporciones , 
            ylim = c(0, max(proporciones)*1.2),
            main="Número de cursos y su frecuencia relativa",
             xlab = "Número de cursos"
            , ylab = "Frecuencia Relativa"
            )
text(b , y = proporciones , labels = proporciones , pos = 3 )
```

El 38% de los de los alumnos llevan 6 cursos y es el número de cursos más común en este estudio (moda)

Además, hay claramente dos valores (3 y 8) de esta variable que claramente ocurren con una frecuencia mucho menor.

Veamos si son atípicos , usando boxplot

```{r}
BP <-boxplot(DF$NumCursos)
BP$out
```

Efectivamente tenemos marcados estos valores como atípicos

Veamos los quantiles:

```{r}
summary(DF$NumCursos)
```

El primer quantil y el tercer quantil son 5 y 6 respectivamente. Dicha información se traduce en que por lo menos el 50% de los alumnos de la muestra llevan entre 5 y 6 cursos.

```{r}
r((nrow(DF %>% filter(NumCursos >= 5 & NumCursos <= 6)) / nrow(DF))*100) 
```

Con mas exactitud el 68.71% de los alumnos llevan entre 5 y 6 cursos

### Promedio de Ingles

Esta variable es numérica discreta. Además , fundamental para el tema ya que es útil para evaluar el desempeño de los estudiantes de nuestra muestra.

Después de la limpieza tenemos:

```{r}
table(!is.na(DF$Promedio_Ingles))
```

El tamaño efectivo de la muestra para esta variable es 163.

Veamos los valores máximos y mínimos

```{r}
summary(DF$Promedio_Ingles)
```

#### Promedio

```{r}
r(mean(DF$Promedio_Ingles,na.rm=T))
```

En esta muestra, los estudiantes obtuvieron una nota promedio de 16.02

#### Mediana

```{r}
r(median(DF$Promedio_Ingles,na.rm=T))
```

En esta muestra, por lo menos la mitad de estudiantes tiene una nota mayor o igual a 17 y , por lo menos la mitad de estudiantes tiene una nota menor o igual a 17

#### Moda

```{r}
DF %>% count(Promedio_Ingles) %>% arrange(-n)
```

En esta muestra, la mayoría de alumnos han obtenido una nota de 17

#### Coeficiente de variación

```{r}
r(cv(DF$Promedio_Ingles))
```

El coeficiente de variación es de 0.18 (menor a 0.3) nos indica una baja variabilidad.

#### Rango

```{r}
range(DF$Promedio_Ingles)
```

Estos valores me indica que hay estudiantes que sacaron como nota mínima un 0 y como nota máxima un 20.

Veamos la cantidad de valores distintos que tenemos en la muestra

```{r}
length(unique(DF$Promedio_Ingles))
```

Como toma varios valores distintos podemos hacer un Histograma

```{r}
media<-mean(DF$Promedio_Ingles,na.rm=T)
mediana<-median(DF$Promedio_Ingles,na.rm=T)

hist(DF$Promedio_Ingles, breaks = 20, las = 0, xlim = c(0, 20), ylim = c(0, 33), main = "Histograma de promedios", xlab = "Notas de examenes de ingles", ylab = "Frecuencia absoluta", sub = "Sesgo hacia la izquierda", labels = F)

abline(v = media, col = "red", lwd = 2)
abline(v = mediana, col = "blue", lwd = 2)

legend(3, 25, legend = c("mean", "median"), col = c("red", "blue"), lwd = 2)
```

Presenta evidentemente un sesgo a la izquierda (a pesar de tener un coeficiente de variación bajo). Esto indica presencia de valores atípicos en el lado izquierdo. En el contexto de la investigación, tenemos pocos alumnos con una nota baja. Es conveniente usar la mediana pues es menos sensible a los datos atípicos.

```{r}
BP<-boxplot(DF$Promedio_Ingles)
```

```{r}
BP$out
```

Efectivamente, tenemos 6 alumnos con una nota menor o igual que 10.

Veamos el RIC:

```{r}
summary(DF$Promedio_Ingles)
```

Por lo menos el 50% de los estudiantes encuestados tienen una promedio entre 15 y 18

```{r}
r((nrow(DF %>% filter(Promedio_Ingles >= 15 & Promedio_Ingles <= 18)) / nrow(DF))*100) 
```

Con más precisión, el 66.26% de los estudiantes encuestados tienen un promedio entre 15 y 18.

### Estado emocional

Esta variable es fundamental para el tema, ya que es útil para analizar el estado emocional de un estudiante y cómo afecta en el proceso del aprendizaje del inglés.

Para esta variable, consideramos una escala del 1-5, siendo 1= "Muy estresado" y 5="Emocionalmente estable". Sabemos que esta variable pertenece dentro de las categóricas ordinales por lo que vemos conveniente utilizar descriptores gráficos.

Vamos a utilizar un diagrama de barras:

```{r}
bar <- barplot(
  round(prop.table(table(DF$Nivel_Estres, useNA = "ifany")), 2),
  ylim = c(0, max(prop.table(table(DF$Nivel_Estres, useNA = "ifany"))) * 1.5),
  col = c("lightblue", "blue4", "green", "lightgreen", "yellow"),
  xaxt = "n",
  main = "Frecuencia relativa de niveles de estrés",
  xlab = "Niveles de estrés",
  ylab = "Frecuencia Relativa"
)

axis(1, at = bar, labels = c(1, 2, 3, 4, 5))

text(bar, y = round(prop.table(table(DF$Nivel_Estres, useNA = "ifany")), 2),
     labels = round(prop.table(table(DF$Nivel_Estres, useNA = "ifany")), 2), pos = 3)


```

Podemos apreciar que la mayoría de los estudiantes encuestados mantienen una postura media o balanceada entre ambos extremos, es decir que no se encuentran ni tan estresados ni tan bien emocionalmente. A este valor mencionado, en la tabla le pertenece al número 3 y equivale al 43% de la población encuestada.

Vamos a ver cuantas personas exactamente han marcado como opción el numero 3:

```{r}
DF %>% count(Nivel_Estres) %>% arrange(-n)
```

Ante esta tabla, se observa que 70 estudiantes de la muestra marcaron el número 3. Además, la categoría `3` es la moda de esta variable. Es decir, la mayoría de estudiantes poseen un nivel de estrés medio.

### Porcentaje de Asistencias

Después de la limpieza tenemos

```{r}
table(!is.na(DF$porcentaje_asist))
```

El tamaño efectivo de la muestra para el Porcentaje de Asistencias es 132.

Es una variable numérica continua. Usaremos los siguientes descriptores numéricos

Veamos los valores máximos y mínimos.

```{r}
summary(DF$porcentaje_asist)
```

El mínimo para el porcentaje de asistencia es 13.33 y el máximo es 100

#### Promedio

```{r}
round(mean(DF$porcentaje_asist , na.rm = T) , 2)
```

Los estudiantes asisten en promedio al 90.2% de sus clases.

#### Mediana

```{r}
round(median( DF$porcentaje_asist , na.rm = T )   ,2)
```

Por lo menos el 50% de los estudiantes asisten a todas sus clases. Veamos cuanto es ese valor exactamente.

```{r}
r((nrow(DF %>% filter(porcentaje_asist == 100)) / nrow(DF[!is.na(DF$porcentaje_asist),]))*100 )
```

El 51.52% de los estudiantes encuestados asisten a todas sus clases de inglés.

```{r}
media<-mean(DF$porcentaje_asist,na.rm=T)
mediana<-median(DF$porcentaje_asist,na.rm=T)

hist(DF$porcentaje_asist, breaks = 10, las = 0, xlim = c(0, 100), ylim = c(0, 100), main = "Histograma de Porcentaje de Asistencia", xlab = "Porcentaje de Asistencias", ylab = "Frecuencia absoluta", sub = "Sesgo hacia la izquierda", labels = F)

abline(v = media, col = "red", lwd = 2)
abline(v = mediana, col = "blue", lwd = 2)

legend(25,100, legend = c("mean", "median"), col = c("red", "blue"), lwd = 2)
```

Claramente vemos una distribución sesgada a la izquierda. Esto en el contexto del estudio significa que hay pocos alumnos con un bajo porcentaje de asistencia bajo.

Examinemos el coeficiente de variación

```{r}
r(cv(DF$porcentaje_asist))
```

El coeficiente de variación es de 0.21 (menor a 0.3) es un valor bajo. Sin embargo, el histograma nos mostró claramente un sesgo negativo. Por ello, es mejor usar la mediana como descriptor de posición.

### Factores de dificultad de aprendizaje del idioma

```{r}
legend_colors <- c("red", "green", "yellow", "blue")
legend_labels <- c("Carga Academica", "Escasa Motivación", "Escasos Recursos", "Razones Externas")
bar <- barplot(
        round(prop.table(table(DF$Factor)) ,2)
        , las = 3 
        , ylim = c(0 , max(prop.table(table(DF$Factor)))*1.5)
        , col = c("red", "green", "yellow", "blue")
        , xaxt = "n"
        ,main="Factor que afecta al aprendizaje y su frecuencia relativa"
        , xlab = "Factor que afecta el aprendizaje"
        , ylab = "Frecuencia Relativa"
        )
factores <- c("Carga Acad." , "Escasa Mot." , "Escasos Recursos" , "R. Externas")

axis(1, at = bar , labels = factores)

text(bar , y = round(prop.table(table(DF$Factor)),2) , 
     labels = round(prop.table(table(DF$Factor)) ,2) , pos = 3 )

legend("topright", legend = legend_labels, fill = legend_colors)

```

La mayoría de los estudiantes encuestados considera que el factor principal que afecta su aprendizaje del inglés es la carga académica (58%)

## Análisis Bivariado

### Correlación entre promedio de Inglés y créditos

```{r}
r(cor(DF$Promedio_Ingles, DF$Creditos, use = "pairwise.complete"))
```

Podemos observar que la variable `Promedio_Inglés` y `Créditos` tienen una relación `débil` y `positiva`, obteniendo un coeficiente de relación de 0.07 aproximadamente. Ambas variables se relacionan con la investigación debido a que es posible que el aprendizaje y notas de inglés de un estudiante dependa de la carga académica que tenga; sin embargo, debido a la relación débil entre estas variables, no se puede concluir que el número de créditos que un alumno cursa afecte de manera significativa su promedio de notas en el idioma, basándose solamente en esta correlación debido a que puede o no, existir otros factores influyentes.

### Promedio de Ingles e Institución

```{r}
BPII <-boxplot(DF$Promedio_Ingles ~ addNA(DF$Ins, ifany = TRUE)
        , las = 3
        , varwidth = TRUE
        , col = c("cyan", "blue3", "red", "lightgray", "darkgray")
        , notch = TRUE
        ,main = "Promedio de Inglés de Instituciones de Inglés", 
        xlab = "Instituciones de Inglés",  
        ylab = "Promedio" ,
        xaxt = "n"
        )
instituciones <- c("Conversa(UTEC)" , "ICPNA" , "Británico" , "Otros" , "Sin Institución")
 axis(1, at = 1:length(instituciones) , labels = instituciones)

text("Institución", side = 3, line = 0, cex = 0.9)

```

Mediante la gráfica, realizamos la comparación entre las instituciones. Esta gráfica sugiere que por lo menos el 50% de los alumnos de ICPNA y Británico tiene un promedio de Ingles mayor o igual a por lo menos 75% de los alumnos de Conversa. Los valores de esos porcentajes son aproximados.

```{r}
quantile(DF$Promedio_Ingles[DF$Ins == "Conversa Academics-UTEC"] , 0.75 , na.rm = T, type = 3)
```

```{r}

(nrow(DF %>% filter(Ins == "ICPNA" & Promedio_Ingles >= 
              quantile(DF$Promedio_Ingles[DF$Ins == "Conversa Academics-UTEC"] , 
                       0.75 , na.rm = T , type = 3)  
              )) / nrow(DF %>% filter(Ins == "ICPNA")))*100 

```

En la muestra , el 62.5% de los alumnos del ICPNA tienen una nota mayor o igual a por lo menos el 75% de alumnos de Conversa

### Promedio de inglés ante nivel de competencia

```{r}
boxplot(DF$Promedio_Ingles ~ DF$Nivel_Competencia
        , las = 1
        , varwidth = TRUE
        , col = c("lightgray", "lightblue" , "blue4" )
        
        ,main = "Promedio de Inglés de los Niveles de Competencia", 
        xlab = "Nivel de competencia del idioma",  
        ylab = "Promedio de inglés"  
        )

```

La gráfica sugiere que al menos el 75% (aproximadamente) de los estudiantes de nivel Avanzado poseen un promedio mayor o igual por lo menos el 75% (aproximadamente) de los estudiantes de nivel básico e intermedio.

```{r}
r(
  (nrow(DF %>% filter(Nivel_Competencia == "Avanzado" & Promedio_Ingles >=  quantile(DF$Promedio_Ingles[DF$Nivel_Competencia == "Básico"] , 
                       0.75 , na.rm = T , type = 3)  )) / nrow(
                         
                         DF %>% filter(Nivel_Competencia == "Avanzado")
                   
                       ))*100
)
```

Con más precisión, el 76.19% de los alumnos de nivel avanzado tienen un promedio mayor o igual a por lo menos el 75% de los alumnos de nivel básico.

### Nivel de Competencia por Instituto

```{r}

mosaicplot(table(DF$Ins, DF$Nivel_Competencia), 
           las = 1, col = c("lightgray", "lightblue", "blue4")
        ,main = "Nivel de Competencia de Instituciones de Inglés", 
        xlab ="Instituciones de Inglés",
        ylab = "Nivel de Competencia"  
        )
```

En nuestra muestra, el Instituto `Conversa Academics(UTEC)` tiene mas del 50% de sus estudiantes en el nivel Básico. Esto contrasta con los institutos `ICPNA` y `Británico` cuya mayoría de estudiantes se encuentra en Intermedio o Avanzado. Además, en nuestra muestra, Conversa no tiene estudiantes en nivel Avanzado.

```{r}
boxplot(DF$Promedio_Ingles ~ DF$Calidad , varwidth = TRUE,
        col = c("red" , "orange" , "yellow" , "green" , "blue4")
      ,main = "Nivel de Calidad de Institutos ante Promedio de Inglés", 
        xlab ="Nivel de Calidad",
        ylab = "Promedio de Inglés",sub = "(Siendo 1= Deficiente y 5= Excelente)", labels = F
        )
```

Aparentemente hay una relación entre la opinión de los alumnos con respecto a su centro de Idiomas y sus notas. Al parecer los alumnos que categorizan a su instituto con el valor "2" rompen la relación (siendo 1 un nivel de calidad deficiente y 5 un nivel muy eficiente). Sin embargo, puede ser producto de la escasa cantidad de muestras. Por otro lado, viendo la calidad de los otros valores hay una relación más evidente.

Observando las categorías "3" , "4" y "5" notamos que por lo menos el 75%(aproximadamente) de los estudiantes de la categoría "5" poseen un promedio mayor o igual a por lo menos el 75%(aproximadamente) de los estudiantes de las categorías "3" y "4".

### Promedio de inglés y Factor de dificultad del aprendizaje

```{r}
legend_colors <- c("red", "green", "yellow", "blue")
legend_labels <- c("Carga Academica", "Escasa Motivación", "Escasos Recursos", "Razones Externas")

boxplot(DF$Promedio_Ingles ~ DF$Factor , 
        las = 2 , 
        varwidth = TRUE
        , xlab = "Factor"
        , ylab = "Promedio"
        , xaxt = "n"
        , col = c("red", "green", "yellow", "blue")
        , main = "Promedio de inglés ante Factor de dificultad de aprendizaje"
        )

 axis(1, at = 1:length(factores) , labels = factores)
legend("bottomright", legend = legend_labels, fill = legend_colors, cex = 0.8, y.intersp = 0.9)

```

Por lo menos el 50% de los alumnos que consideran a la `Carga Académica` como principal factor involucrado en su aprendizaje tienen un promedio mayor o igual a por lo menos el 50% de los estudiantes que considera la `Escasa Motivación`. Además, la gráfica sugiere que el factor que más afecta el desempeño es `Escasos Recursos`. Sin embargo, también es el factor con menos observaciones en nuestra muestra.

### Institución y Factor de dificultad de aprendizaje

```{r}
mosaicplot(table(DF$Ins , DF$Factor) , las = 1
           , main = "Factores de dificultad de aprendizaje por Institución"
           , col = c("red", "green", "yellow", "blue")
           , xlab = "Institución de inglés"
           , ylab = "Factor"
           )
```

La gráfica sugiere que el aprendizaje del idioma de los estudiantes de `Conversa Academics` se dificulta principalmente por el factor `Carga Académica`. Además, se puede observar que la proporción de alumnos que consideran dicho factor es mayor en `Conversa Academics(UTEC)` que en sus principales competidores `ICPNA`y `Británico`. Finalmente, observamos que el instituto `Conversa Academics(UTEC)` tiene la mayor proporción de estudiantes que consideran al factor `Escasos Recursos`.



## Probabilidad Empírica

### Variable Nivel de Competencia

Justificación: La variable `Nivel de Competencia` es importante debido a su correlación con otras variables como `Institución` y `Promedio de Inglés`. Además, determinar un espacio de probabilidad asociado a algún evento que involucra esta variable puede ser interesante para la realización de los objetivos.

Como vimos en el `Análisis Descriptivo` guarda relación con las Variables `Institución` y `Promedio`

```{r}
mosaicplot(table(DF$Ins, DF$Nivel_Competencia), 
           las = 1, col = c("lightgray", "lightblue", "blue4")
        ,main = "Nivel de Competencia de Instituciones de Inglés", 
        xlab ="Instituciones de Inglés",
        ylab = "Nivel de Competencia"  
        )
```

```{r}
boxplot(DF$Promedio_Ingles ~ DF$Nivel_Competencia
        , las = 1
        , varwidth = TRUE
        , col = c("lightgray", "lightblue" , "blue4" )
        
        ,main = "Promedio de Inglés de los Niveles de Competencia", 
        xlab = "Nivel de competencia del idioma",  
        ylab = "Promedio de inglés"  
        )
```

Definición del experimento aleatorio:

`E1` : Escojo un estudiante de UTEC y observo el `Nivel de Compentencia` que presenta en el idioma Inglés.

Para determinar de manera correcta las probabilidades empíricas de los eventos atómicos mediante el uso de la muestra se tratará los `NA's` de la siguiente manera:

```{r}
DF <- DF %>% mutate(Nivel_Comp = coalesce(DF$Nivel_Competencia , "Indefinido"))
```

La columna `Nivel_Comp` tiene a los valores `NA` como indefinido. Puesto que en base a la muestra, al escoger al azar un estudiante de UTEC puede que no esté definido su `Nivel de Competencia`

```{r}
table(DF$Nivel_Comp)
```

#### Espacio de Resultados

Se definen los eventos atómicos: El estudiante tiene nivel Básico, El estudiante tiene nivel Intermedio y el estudiante tiene nivel Avanzado.

$$\Omega_{1} = \{Básico , Intermedio , Avanzado , Indefinido\}$$

$$F_{1} = 2^{|\Omega_{1}|} = 16$$

#### Cálculo de las probabilidades de los eventos atómicos

Calculamos las probabilidades atómicas.

```{r}
round(prop.table(table(DF$Nivel_Comp)), 2)
```

Se verifica que la suma de las probabilidades de los eventos atómicos de 1.

$$
\sum\mathbb{P}(Ea) = 1
$$

```{r}
sum(round(prop.table(table(DF$Nivel_Comp)), 2))
```



$$\mathbb{P}(Básico) = 0.31 \\ \mathbb{P}(Intermedio) = 0.39 \\ \mathbb{P}(Avanzado) = 0.26 \\ \mathbb{P}(Indefinido) = 0.04$$

Al escoger al azar un alumno de UTEC es más probable que sea del `Nivel Intermedio`. Además la probabilidad de que el alumno tenga un nivel `Indefinido` es baja en comparación al resto.

#### Variable Nivel de Estrés

Justificación:

La variable nivel estrés está fuertemente relacionada con los objetivos número 1 y 2, el cual establece las dificultades y factores que podrían atravesar los estudiantes al momento de su aprendizaje de inglés, debido a que esta puede o no ser dependiente de otras variables del estudio y demostrar una relación con ellas.

`E2` : Escojo al azar un estudiante de UTEC y observo el `Nivel de Estres` que poseen en una escala del 1 al 5. Donde: 1 significa que tiene un nivel de estrés bajo y 5 significa que tiene un nivel de estrés alto.

Usamos nuestra muestra para representar los resultados del experimento `E2`

#### Espacio de Resultados

Los eventos atómicos para este experimento aleatorio son: El estudiante tiene el nivel 1, El estudiante tiene el nivel 2, el estudiante tiene el nivel 3, el estudiante tiene el nivel 4, El estudiante tiene el nivel 5.

$$\Omega_{2} = \{ 1 , 2 , 3 , 4 , 5\}$$ 


$$ {F}\_{2} = 2 ^ {\|\Omega{2}\|} = 32 $$

```{r}
table(DF$Nivel_Estres)
```


```{r}
r(prop.table(table(DF$Nivel_Estres)))
```


Se verifica que la suma de las probabilidades de los eventos atómicos de 1.


$$
\sum\mathbb{P}(Ea) = 1
$$


```{r}
sum(r(prop.table(table(DF$Nivel_Estres))))
```




$$\mathbb{P}(1) = 0.09 \\ \mathbb{P}(2) = 0.21 \\ \mathbb{P}(3) = 0.43 \\ \mathbb{P}(4) = 0.19 \\ \mathbb{P}(5) = 0.08$$

Si escojo al azar un alumno de UTEC lo más probable es que tenga un nivel de estrés medio (3 en la escala del 1 al 5).

## Eventos Dependientes e Independientes

Usaremos el siguiente criterio

$$|\mathbb{P}(A \cap B) - \mathbb{P}(A)*\mathbb{P}(B)| < 0.01$$

para determinar la independencia de dos Eventos.

### Eventos Dependientes:

Inicialmente, intuimos que un estudiante tenga un determinado `Nivel de Competencia` y pertenezca a una determinada `Institución` no deberían estar relacionados. Sin embargo, viendo el siguiente gráfico.

```{r}
mosaicplot(table(DF$Ins, DF$Nivel_Competencia), 
           las = 1, col = c("lightgray", "lightblue", "blue4")
        ,main = "Nivel de Competencia de Instituciones de Inglés", 
        xlab ="Instituciones de Inglés",
        ylab = "Nivel de Competencia"  
        )
```

Nos da una idea de que podría haber eventos relacionados a estas variables que sean dependientes.

`E3`: Escoger al azar un alumno de UTEC y anotamos su `Nivel de Competencia` y su `Institución`

Definimos los eventos A y B

`A` : Que el alumno sea de nivel Básico

`B` : Que el alumno sea del ICPNA

Los `NA` en la variable `Ins` son los alumnos que no están relacionados con ningún Instituto de Idiomas

```{r}
DF <- DF %>% mutate(Instituto = coalesce(DF$Ins , "Sin INS"))
```

```{r}
addmargins(table(DF$Nivel_Comp , DF$Instituto))
```

```{r}
PA<-(50/163)
PB<-(40/163)
PAB<-(8/163)
PA*PB
PAB
abs(PA*PB-PAB) < 0.01
```

La diferencia positiva entre la P(AB) y P(A)P(B) es mayor o igual a 0.01. Por lo tanto, son dependientes. Es decir, si escojo al azar un alumno de UTEC y tiene nivel `Básico`, esta premisa afecta en cierto sentido que el alumno provenga del instituto de idiomas `ICPNA`

Utilizamos Teorema de Bayes

```{r}
ProbAdadoB  <- 8/40
ProbBdadoA <- 8/50
```

Calculamos la $\mathbb{P}(A|B) $ con Bayes:

```{r}
ProbAdadoB

(ProbBdadoA*PA)/PB

PA
```

Probabilidad Total

Calcularemos la probabilidad B con la formula de probabilidad total

```{r}
PB
PA
ProbBdadoA
PAc <- 1 - PA
ProbBdadoAc <- 32/113

PA*ProbBdadoA + PAc*ProbBdadoAc
```



### Eventos independientes

Definimos el siguiente experimento aleatorio.

`E4`: Escoger un alumno al azar y fijarse en su número de `Créditos` y `Nivel de Estres`

```{r}
boxplot(DF$Creditos ~ DF$Nivel_Estres)
```

Mediante el uso de `Boxplot` podemos ver que las variables no guardan una relación muy clara. No se puede decir que si una aumenta implica que la otra aumente.

Por ello, si planteamos `Eventos` asociados a estas variables, podríamos obtener eventos independientes.


Definimos los eventos E y F

`E`: Que el alumno tenga un nivel de estrés 5 (alto)

`F` : Que el alumno esté llevando un número de créditos académicos mayor o igual a 15


```{r}
DF$Rango_Creditos <- ifelse(DF$Creditos < 15, TRUE, FALSE)
addmargins(table(DF$Rango_Creditos , DF$Nivel_Estres))
```

```{r}
PE <- 13/163
PF <- 145/163

PEF  <-12/163

abs(PE*PF - PEF)  < 0.01 
```

La diferencia es menor que 0.01. Por lo tanto los eventos son aproximadamente Independientes. Es decir si selecciono al azar un alumno y este tiene un Promedio de Ingles mayor o igual a 15 no condiciona o afecta a que este tenga o no un nivel de estrés de 5.


```{r}
ProbEdadoF <- 12/145
ProbEdadoF
PE
```

$\mathbb{P}(E|F)$ es similar a $\mathbb{P}(E)$

Calculamos la $\mathbb{P}(E|F)$ con Bayes:

```{r}
ProbEdadoF
ProbFdadoE <- 12/13
(ProbFdadoE*PE)/PF

PE
```
Notamos que la $\mathbb{P}(E|F)$ es similar a la $\mathbb{P}(E)$, se evidencia una vez más que son aproximadamente independientes

## Variables Discretas


### Variable Promedio de Ingles:

#### Distribución Binomial:

Usaremos a la variable numérica discreta `Promedio de Inglés` para definir una Variable Aleatoria Discreta (Binomial) que cuente el número de alumnos con un promedio mayor o igual a 15 que se puede obtener al sacar una muestra de tamaño $ n = 163 $ (tamaño de nuestra muestra). Además, asumiremos que nuestra muestra es representativa para calcular la Probabilidad de Éxito.

`E1` : Escoger una muestra de `163` alumnos de `UTEC` (con reemplazo) contar el número de alumnos que tienen un promedio de `Inglés` mayor o igual a 15.

Éxito: Que el alumno seleccionado tenga un `Promedio de Inglés` mayor o igual a 15.

Definimos la probabilidad de Éxito. Asumiendo que la muestra es representativa.

```{r}
p <- r((nrow(DF %>% filter(Promedio_Ingles >= 15) ) )/ nrow(DF))
p
```
Definimos el valor de `n`.

```{r}
n <- 163
```



$$
X : \text{Número de alumnos con un Promedio de Inglés mayor o igual a 15 en una muestra de 163 alumnos de UTEC (con reposición) } \\

X ~ Bin(n,p) = Bin(163 , 0.79) \\

Rango(X) = [163] \text{ } \cup \text{ } 0 

$$

```{r}
rango <- 0:163

par(fig = c(0, 1, 0, 1), mar = c(5, 5, 4, 2) + 0.1)
plot(100:150, dbinom(100:150, n, p), type = 'h', lwd = 2, xlab = "Número de éxitos", ylab = "Probabilidad", main = "Distribución Binomial")

```


Si sumamos la función de masa de probabilidad evaluada en todos los elementos del rango da 1.

```{r}
sum( dbinom(rango , n , p))
```

#### Valor esperado:

$$ 
\text{Se sabe que el valor esperado de una distribución binomial es:} \text{ } \mathbb{E}(X) =  np 
$$

```{r}
media <- n*p
media
```
Esto quiere decir que en promedio 128.77 alumnos tendrán un `Promedio de Ingles` mayor o igual a 15. 



$$
\text{Sin emabargo, sabemos que la podemos calcular de la siguiente forma} \\

\mathbb{E}(X) = \sum_{x \text{ } \in \text{} Ran(X) } xp(x)
$$
Veamos este calculo con R:


```{r}
Ex <-sum(rango*dbinom(rango , n , p))
media
Ex

```
Notamos que ambos valores coinciden.

#### Varianza:

$$
\text{Sabemos que la Varianza de una variable alteatoria Binomial se calcula de la siguienete manera: } \\
Var(X) = np(1-p)
$$
```{r}
var <- n*p*(1-p)
var
```
Comprobaremos con la forma general :

$$
Var(X) = \sum_{x \text{ } \in \text{ } Ran(X)}(x-E(X))^{2}p(x)
$$
```{r}
Varx <-sum( ((0:163 - Ex)^2)*dbinom(0:163,n,p))

Varx
var
```


Ejemplo Práctico : ¿Cual es la probabilidad que al sacar una muestra de 163 alumnos de UTEC (con reemplazo) el número de alumnos con un `Promedio de Inglés`mayor o igual a 15 este entre 100 y 120, sabiendo que la probabilidad de encontrar un alumno de UTEC con dichas características es 0.79?

Solución:

Usando `dbinom` :

```{r}
sum(dbinom(100:120 , n , p))
```
Usando `pbinom`


```{r}
pbinom(120, n , p) - pbinom(100, n, p)
```


### Variable Número de Créditos

#### Distribución Hipergeométrica

Usaremos la variable `Créditos` para definir la siguiente variable aleatoria hiper-geométrica.


```{r}
nrow(DF %>% filter(Creditos > 18))
```


$$
Y =  \text{Número de alumnos que llevan mas de 18 créditos si escojo 50 alumnos} \\
\text{de un total 163 donde existen 105 alumnos que cumplen la condición }
$$



```{r}
N <- 163 #tamaño de la población
n <- 50 #tamaño de la muestra
k <- 105 # numero total de éxitos
```



$$ Y - H(163,50,105) $$

El rango de la variable es :

$$
     Rang(Y) = [50] \cup 0      
$$
Gráfica

```{r}
rango <- 0:50

par(fig = c(0, 1, 0, 1), mar = c(5, 5, 4, 2) + 0.1)
plot(0:50, dhyper(0:50 , k , N-k, n), type = 'h', lwd = 2, xlab = "Número de éxitos", ylab = "Probabilidad", main = "Distribución Hipergeométrica")
```


Media:

1) Fórmula

$$
  \text{La media (Valor esperado) de una variable aleatoria Hipergeométrica es : } E(Y) = n\frac{k}{N}
$$

```{r}
media <- n*(k/N)
media
```

2) Sumatoria

$$\text{Tambien se puede calcular : } \mathbb{E}(Y) = \sum_{y \text{ } \in \text{} Ran(Y) } yp(y) $$

```{r}
Ex <- sum(0:50*dhyper(0:50 , k , N-k, n))
Ex
```


Varianza:

1) Usando formula

$$
\text{Var}(Y) = \frac{n \cdot k \cdot (N - k) \cdot (N - n)}{N^2 \cdot (N - 1)}

$$


```{r}
varianza <- (n*k*(N-k)*(N-n))/(N*N*(N-1))
varianza
```

2) Sumatoria

$$
Var(Y) = \sum_{y \text{ } \in \text{ } Ran(Y)}(y-E(y))^{2}p(y)
$$


```{r}
Varx <-sum( ((0:50 - Ex)^2)*dhyper(0:50,k,N-k , n))
Varx
```


Ejemplo Práctico: 

Se saca una muestra de 50 alumnos de un total de 163, donde 105 alumnos llevan mas de 18 créditos.

Cual es la Probabilidad que el número de alumnos que llevan más de 18 créditos esté entre 30 y 40.

$$
\text{Nos piden : } \mathbb{P}( 30<=Y <= 40) 
$$
Usando `dhyper`

```{r}
sum(dhyper(30:40 , k , N-k , n ))
```

Usando `phyper`

```{r}
phyper(40, k, N-k , n) - phyper(29 , k , N-k , n) 
```


## Variables Continuas

```{r}
library(rriskDistributions)
```


```{r}
porcentaje <-DF$porcentaje_asist[!is.na(DF$porcentaje_asist)]

fit.cont(porcentaje)
```



```{r}
plot(density(DF$porcentaje_asist , na.rm = T))

library('nortest')
```



```{r}
lillie.test(DF$porcentaje_asist)
```

```{r}
library(dplyr)
```



```{r}
data <- DF %>% filter(DF$porcentaje_asist >= 10 & porcentaje_asist <= 60)

data


plot(density(data$porcentaje_asist))

```

```{r}
DF %>% select(porcentaje_asist) %>% group_by(porcentaje_asist) %>% count() %>% arrange(-n)
```





```{r}
v1 <- as.numeric(DF$Calidad)

DF$razonCalidadAsistencia <- as.numeric(DF$Calidad)/DF$porcentaje_asist

plot(density(DF$razonCalidadAsistencia , na.rm = T))


```


```{r}
library(fitdistrplus)
```


```{r}
data1 <- DF %>% filter(!is.na(porcentaje_asist))
data1

fit.in1 <- fitdist(data1$porcentaje_asist, "norm")
fit.in2 <- fitdist(data1$porcentaje_asist, "unif")
fit.in3 <- fitdist(data1$porcentaje_asist, "exp")
```

```{r}
denscomp(list(fit.in1,fit.in2,fit.in3),legendtext=c("Normal","Uniform","Exponential"))
```





```{r}
hist(DF$Creditos)
```



```{r}

```



