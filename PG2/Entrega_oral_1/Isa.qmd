---
title: "Jeff"
format: html
editor: visual
---

## Item 2

Programan en c++ -\> ansiedad

```{r}
cmasmas <- sum(encuesta$`C++`[encuesta$`C++` == TRUE])  
probabilidad <- cmasmas/nrow(encuesta)
probabilidad
```

```{r}
ansiedad <- sum(encuesta$Ansiedad[encuesta$Ansiedad == TRUE])
probabilidad2 <- ansiedad/nrow(encuesta)
probabilidad2
```

```{r}
pruebita <- data.frame(cmasmas = c(probabilidad, 1-probabilidad),
                       ansiedad = c(probabilidad2, 1- probabilidad2))
pruebita
```

```{r}
mosaicplot(table(encuesta$JavaScript, encuesta$Ansiedad),
           main = "Gráfico de Mosaico",
           xlab = "Variable1",
           ylab = "Variable2")
```

Las personas que trabajan en el lenguaje mas usado y que tenga menos salario que el promedio / tenga ansiedad

```{r}
CantUsers <- c()

for (lang in language){
  this <- encuesta[encuesta[lang] == TRUE,]
	cantidad <- nrow(this)
	CantUsers <- c(CantUsers, cantidad)
}

df1 <- data.frame(language, CantUsers)

df1 %>% arrange(desc(CantUsers)) -> df1

df1$language[df1$CantUsers == max(df1$CantUsers)]
```

**Las personas que trabajan con JavaScript y que tenga menos salario que el promedio \| tenga ansiedad**

```{r}
mean(encuesta$Salary)
```

Las personas que trabajan en JavaScript con salario \< 76153.59 / tenga ansiedad

```{r}
cantidad <- sum(encuesta$JavaScript == TRUE & encuesta$Salary < 76153.59)
cat("La cantidad de personas que trabajan en JavaScript con salario < 76153.59:", cantidad)
```

Probabilidad (Las personas que trabajan en JavaScript con salario \< 76153.59)

```{r}
probJSsalario <- cantidad/nrow(encuesta)
probJSsalario
```

```{r}
cantAnsiedad <- sum(encuesta$Ansiedad[encuesta$Ansiedad == TRUE])
cantAnsiedad
probabilidadAnsiedad <- ansiedad/nrow(encuesta)
probabilidadAnsiedad
```

```{r}
pruebita2 <- data.frame(probabilidadJavaScript = c(probJSsalario, 1-probJSsalario),
                       probabilidad_ansiedad = c(probabilidadAnsiedad, 1- probabilidadAnsiedad),
                       row.names = c("JavaScript", "No JavaScript"))
pruebita2
```

```{r}
# Crear la tabla de contingencia
tabla <- table(pruebita2$probabilidadJavaScript, pruebita2$probabilidad_ansiedad)

# Generar el mosaico plot
mosaicplot(tabla, main = "Gráfico de Mosaico", xlab = "JavaScript", ylab = "Ansiedad")

```

```{r}
df2 <- encuesta[encuesta$JavaScript == TRUE & encuesta$Salary < 76153.59 & encuesta$Ansiedad == TRUE, ]
Interseccion <- nrow(df2)/nrow(encuesta)
Interseccion
```

```{r}
ProbCondicional <- Interseccion/probabilidadAnsiedad
ProbCondicional
```

```{r}


datos_filtrados <- subset(encuesta, encuesta$JavaScript == TRUE & Salary < 76153.59)

personas_ansiedad <- sum(datos_filtrados$Ansiedad == TRUE)
personas_ansiedad

total_personas <- nrow(datos_filtrados)
total_personas

# Paso 5: Crear el objeto de datos para el mosaicplot con las frecuencias correspondientes
datos_mosaicplot <- matrix(c(personas_ansiedad, total_personas - personas_ansiedad, total_personas), nrow = 3, byrow = TRUE)

datos_mosaicplot

# Paso 6: Realizar el mosaicplot con ejes personalizados
# mosaicplot(datos_mosaicplot, main = "Relación entre el uso de JavaScript, ganancias y ansiedad",
#           xlab = "Cantidad de personas que programan en JavaScript y ganan menos de $73,000",
#           ylab = "Cantidad de personas que sufren ansiedad")
```

```{r}
A <- table(encuesta$JavaScript == TRUE & encuesta$Salary < 76153.59)
B <- table(encuesta$Ansiedad == TRUE)

matrix <- matrix(c(A, B), nrow = 2)



mosaicplot(matrix)
```
