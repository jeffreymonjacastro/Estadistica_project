---
title: "Estudio sobre la relación entre las tecnologías que usan los desarrolladores en su trabajo y su salud mental"
author: '**Grupo 7** 
  Integrantes: 
    Isabella Romero, 
    César Perales, 
    Jeffrey Monja,
    Edwid Pinto,
    Sebastián Rodriguez'
date: "7 de julio del 2023"
output:
  ioslides_presentation:
    css: 'styles.css'
    widescreen: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Objetivos y datos

### Objetivo principal

> Demostrar que la salud mental del programador depende, en parte, del lenguaje de programación que escoja para trabajar.

### Objetivos secundarios

-   Demostrar que la popularidad de un lenguaje de programación no significa que trabajar con este brinde un mejor estado de salud mental.

-   Encontrar una relación entre el acceso a información del lenguaje de programación escogido por el programador y su salud mental.

-   Encontrar una relación entre el salario que brinda el lenguaje de programación que usan los desarrolladores con su salud mental.

-   Demostrar la relación entre el sistema operativo utilizado en el ámbito profesional y la salud mental de los individuos, y encontrar una posible asociación entre los problemas mentales y el tipo de sistema operativo.

### Bases de datos

-   Programming language database (PLDB)

-   Survey_results 2022 (Stack Overflow)

```{r, include=FALSE}
library(readr)
library(dplyr)
library(readr)
library(ggplot2)
library(tidyverse)
library(stringr)
```

```{r warning = FALSE, include=FALSE}
languages = read_csv("Programming_languages.csv")
encuesta = read_csv("survey_results_limpia.csv")
```

# Analisis Descriptivo

## Analisis Univariado.

<div class="two-column">

<div class="column">

Salario.

```{r echo=FALSE}
encuesta %>%
 ggplot() +
  aes(x = Salary) +
  geom_density(adjust = 1L, fill = "#B8FFB8") +
  labs(
    x = "Salario anual en dolares",
    y = "Densidad",
    title = "Densidad Salarial"
  ) +
  theme_minimal()
```

</div>

<div class="column">

Cantidad de usuarios por lenguaje.

```{r echo=FALSE}
language <- encuesta %>%
  separate_rows(ProgLanguages, sep = ";") %>%
  group_by(ProgLanguages) %>%
  summarize() %>%
  pull()

CantUsers <- c()

for (lang in language){
  this <- encuesta[encuesta[lang] == TRUE,]
	cantidad <- nrow(this)
	CantUsers[lang] <- cantidad
}

CantUsers <- sort(CantUsers, decreasing = TRUE)

df1 <- data.frame(CantUsers)

barplot(df1$CantUsers, 
  main="Cantidad de usuarios por lenguaje de programación", 
  xlab="Lenguaje de programación", 
  ylab="Cantidad de usuarios",
  names.arg = row.names(df1),
  col=colorRampPalette(c("darkred", "red"))(15),
  xlim = c(0,50),
  las=2,
  cex.names=0.5,
  cex.axis=0.5,
  )
```
</div>

</div>

## Analisis bivariado (Salud mental, Lenguaje de programación)

```{r echo=FALSE}
memoria <- filter(encuesta, Memoria == TRUE)
ansiedad <- filter(encuesta, Ansiedad == TRUE)
emocional <- filter(encuesta, Emocional == TRUE)
autismo <- filter(encuesta, Autismo == TRUE)
aprendizaje <- filter(encuesta, Aprendizaje == TRUE)
```

<div class="two-column">


<div class="column2">
Memoria

```{r echo=FALSE}
porcentajes <- c()

for (current in language){
	cantidad = nrow(memoria[memoria[[current]] == TRUE, ])
	cantidadTotal = nrow(encuesta[encuesta[[current]] == TRUE, ])
	porcentajes[current] <- cantidad/cantidadTotal
}

porcentajes <- sort(porcentajes, decreasing = TRUE)

porcentajes = data.frame(porcentajes)

porcentajeshelper <- porcentajes$porcentajes[1:15]
nombres <- rownames(porcentajes)[1:15]

barplot(porcentajeshelper, 
	main="% Personas que sufren de problemas de Memoria", 
	xlab="Porcentaje de personas", 
  col=colorRampPalette(c("darkblue", "blue"))(15),
	xlim = c(0,0.22),
	horiz=TRUE,
	las=1,
	names.arg=nombres,
	cex.names=0.5,
	cex.axis=0.5,
	)
```
</div>

<div class="column2">

Ansiedad

```{r echo=FALSE}
porcentajes <- c()

for (current in language){
	cantidad = nrow(ansiedad[ansiedad[[current]] == TRUE, ])
	cantidadTotal = nrow(encuesta[encuesta[[current]] == TRUE, ])
	porcentajes[current] <- cantidad/cantidadTotal
}

porcentajes <- sort(porcentajes, decreasing = TRUE)

porcentajes = data.frame(porcentajes)

porcentajeshelper <- porcentajes$porcentajes[1:15]
nombres <- rownames(porcentajes)[1:15]

barplot(porcentajeshelper, 
	main="% Personas que sufren de problemas de Ansiedad", 
	xlab="Porcentaje de personas", 
  col=colorRampPalette(c("darkblue", "blue"))(15),
	xlim = c(0,0.16),
	horiz=TRUE,
	las=1,
	names.arg=nombres,
	cex.names=0.5,
	cex.axis=0.5,
	)
```

</div>


<div class="column2">

Emocional

```{r echo=FALSE}
porcentajes <- c()

for (current in language){
	cantidad = nrow(emocional[emocional[[current]] == TRUE, ])
	cantidadTotal = nrow(encuesta[encuesta[[current]] == TRUE, ])
	porcentajes[current] <- cantidad/cantidadTotal
}

porcentajes <- sort(porcentajes, decreasing = TRUE)

porcentajes = data.frame(porcentajes)

porcentajeshelper <- porcentajes$porcentajes[1:15]
nombres <- rownames(porcentajes)[1:15]

barplot(porcentajeshelper, 
	main="% Personas que sufren de problemas emocionales", 
	xlab="Porcentaje de personas", 
  col=colorRampPalette(c("darkblue", "blue"))(15),
	xlim = c(0,0.2),
	horiz=TRUE,
	las=1,
	names.arg=nombres,
	cex.names=0.5,
	cex.axis=0.5,
	)
```


</div>


<div class="column2">

Autismo

```{r echo=FALSE}
porcentajes <- c()

for (current in language){
	cantidad = nrow(autismo[autismo[[current]] == TRUE, ])
	cantidadTotal = nrow(encuesta[encuesta[[current]] == TRUE, ])
	porcentajes[current] <- cantidad/cantidadTotal
}

porcentajes <- sort(porcentajes, decreasing = TRUE)

porcentajes = data.frame(porcentajes)

porcentajeshelper <- porcentajes$porcentajes[1:15]
nombres <- rownames(porcentajes)[1:15]

barplot(porcentajeshelper, 
	main="% Personas que sufren de problemas de Autismo", 
	xlab="Porcentaje de personas", 
  col=colorRampPalette(c("darkblue", "blue"))(15),
	xlim = c(0,0.15),
	horiz=TRUE,
	las=1,
	names.arg=nombres,
	cex.names=0.5,
	cex.axis=0.5,
	)
```

</div>


<div class="column2">

Aprendizaje

```{r echo=FALSE}
porcentajes <- c()

for (current in language){
	cantidad = nrow(aprendizaje[aprendizaje[[current]] == TRUE, ])
	cantidadTotal = nrow(encuesta[encuesta[[current]] == TRUE, ])
	porcentajes[current] <- cantidad/cantidadTotal
}

porcentajes <- sort(porcentajes, decreasing = TRUE)

porcentajes = data.frame(porcentajes)


porcentajeshelper <- porcentajes$porcentajes[1:15]
nombres <- rownames(porcentajes)[1:15]

barplot(porcentajeshelper, 
	main="% Personas que sufren de problemas de Aprendizaje", 
	xlab="Porcentaje de personas", 
  col=colorRampPalette(c("darkblue", "blue"))(15),
	xlim = c(0,0.1),
	horiz=TRUE,
	las=1,
	names.arg=nombres,
	cex.names=0.5,
	cex.axis=0.5,
	)
```

</div>

</div>

Lenguajes **"problemáticos"**(los tres con más frecuencia en cada problema): [Lua, Crystal, Erlang] U [Lya, Ruby, SAS] U [LISP, Lua, Erlang] U [Rust, Lua, Crystal] U [Assembly, Lua, APL]

> Lua, Crystal, Erlang, Lya, Ruby, SAS, Lisp, Rust, Assembly, APL

## Analisis Bivariado (Salario asociado a un lenguaje, Estado mental)

<div class="two-column">

<div class="column3">

Promedios

```{r echo=FALSE}
promedios <- c()

for (current in language){
  this <- encuesta[encuesta[current] == TRUE,]
	promedio <- mean(this$Salary[language == current])
	promedios[current] <- promedio
}

promedios <- sort(promedios, decreasing = TRUE)

promedios <- data.frame(promedios)

porcentajeshelper <- promedios$promedios[1:15]
nombres <- rownames(promedios)[1:15]

barplot(porcentajeshelper, 
	main = "Promedio del Salario para cada Lenguaje de Programación", 
	xlab = "Promedio de salarios", 
	ylab = "Lenguaje de Programación",
  col=colorRampPalette(c("darkgreen", "green"))(15),
	horiz=TRUE,
	xlim = c(0, 140000),
	las=1,
	names.arg=nombres,
	cex.names=0.5,
	cex.axis=0.5,
	)
```

</div>


<div class="column3">

Medianas

```{r echo=FALSE}
medianas <- c()

for (current in language){
  this <- encuesta[encuesta[current] == TRUE,]
	promedio <- median(this$Salary[language == current])
	medianas[current] <- promedio
}

medianas <- sort(medianas, decreasing = TRUE)
medianas <- data.frame(medianas)

porcentajeshelper <- medianas$medianas[1:15]
nombres <- rownames(medianas)[1:15]

barplot(porcentajeshelper, 
	main = "Mediana del Salario para cada Lenguaje de Programación", 
	xlab = "Medianas del Salario",
	ylab = "Lenguaje de Programación",
  col=colorRampPalette(c("darkgreen", "green"))(15),
	horiz=TRUE,
	xlim = c(0, 140000),
	las=1,
	names.arg=nombres,
	cex.names=0.5,
	cex.axis=0.5,
	)
```

</div>

<div class="column3">

Boxplot (Problemas Mentales \| Salario \| Enfermedad Mental)

```{r echo=FALSE}
encuesta %>%
  select(Memoria, Emocional, Ansiedad, Autismo, Aprendizaje, Salary) %>%
  pivot_longer(cols = -Salary, names_to = "Problemas Mentales", values_to = "Sufre") %>%
  ggplot() +
  aes(x = Salary, y = `Problemas Mentales`, fill = Sufre) +
  geom_boxplot(alpha = 0.5) +
  theme_minimal()
```

</div>

</div>

# Analisis Probabilistico

## Variable aleatoria (Total Lenguajes de Programación)

Variable aleatoria discreta: Cantidad de lenguajes de programación que usa un usuario de Stack Overflow.

<div class="two-column">

<div class="column4">

```{r echo=FALSE}
hist(encuesta$TotalLenguajes,
     col = "skyblue",
     main = "Histograma del total de lenguajes de Programación",
     xlab = "Cantidad de lenguajes", 
     ylab = "Frecuencia",
     breaks = 20
)

abline(v= mean(encuesta$TotalLenguajes), col = "red", lty = 1)

abline(v= median(encuesta$TotalLenguajes), col = "blue", lty = 2)

legend("topright", legend = c("Media", "Mediana"), col = c("red", "blue"), lty = c(1, 2))
```
</div>

<div class="column4">
```{r}
encuesta %>% group_by(TotalLenguajes) %>% count() -> probTotalLenguajes
probTotalLenguajes %>% rename(Frecuencia = n) -> probTotalLenguajes

probTotalLenguajes$ProbabilidadAtomica <- probTotalLenguajes$Frecuencia / nrow(encuesta)


```

</div>

</div>

> Media: 4.989317
>
> Mediana: 5
